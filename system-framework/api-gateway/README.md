### 统一的服务网关
### spring cloud 集成security oauth2鉴权实现方式分为2种

#### 第一种, 由网关统一鉴权
- 优点：业务服务只允许外部通过网关访问,默认网关可信,业务服务不需要关系鉴权信息,简化实现
- 问题点: 如果业务存在不需要鉴权的接口，网关需要一一维护起来，网关工作量会加大
    - 解决办法: 可以通过业务服务启动时候，将公开接口和不公开接口都存储到redis，网关从缓存获取
- 问题点: 网关统一拦截，下层服务的url必须要指定统一的规则
    - 解决办法: 1.从开发规范上约束 2.网关只路由白名单(也就是开发规范允许的)

#### 第二种，网关只负责限流、路由、基础校验，不做鉴权操作
- 优点：网关独立，不受业务服务影响
- 问题点：每个业务服务都需要作为资源服务提供者，需要自定义各自的配置；业务服务间feign调用，会造成重复鉴权
    - 解决办法(暂未未去实现):
           考虑重写resource拦截的校验服务ResourceServerTokenServices的实现类UserInfoTokenServices,
           在完成校验之后，将鉴权中心返回的数据添加到请求头中(此处可以通过protocol的方式编码)
           每个服务都依赖重写的服务类，检查请求头中是否已经存在，如果已经存在跳过检查，从头中解析即可
           为了防止前端伪造，在网关中必须首先移除掉请求头的字段